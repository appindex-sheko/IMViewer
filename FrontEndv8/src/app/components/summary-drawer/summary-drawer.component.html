<!-- default summary template -->
<ng-template #defaultSummaryTemplate let-summaryProvider="summaryProvider">

  <div>{{summaryProvider.concept.name}}</div>

</ng-template>

<!-- valueset summary templates -->
<ng-template #emptyValueSetTemplate>
  <div>Value Set has no members</div>
</ng-template>

<ng-template #valueSetSummaryTemplate let-summaryProvider="summaryProvider">
    <div *ngIf="summaryProvider.valueSet.isEmpty(); else emptyValueSetTemplate">
        <mat-action-list #members> 
          <mat-list-item *ngFor="let member of summaryProvider.valueSet.members | slice: summaryProvider.pageStartIndex : summaryProvider.pageEndIndex" [matTooltip]="member.name">
            <mat-icon mat-list-icon>add_circle</mat-icon> // only show circle on non members
            <span class="no-wrap">{{member.name}} ({{member.iri}})</span>
          </mat-list-item>
        </mat-action-list>
        <div style="bottom: 0; right: 0; position: absolute">
          <mat-paginator [length]="summaryProvider.valueSet.members.length" [pageSize]="summaryProvider.pageSize" [pageSizeOptions]="summaryProvider.pageSizeOptions" (page)="summaryProvider.onPageChange($event)" [showFirstLastButtons]=false>
          </mat-paginator>
        </div>
      </div>
</ng-template>

<!--datamodel summary template -->
<ng-template #dataModelSummaryTemplate let-summaryProvider="summaryProvider">
  <table mat-table [dataSource]="hoveredDataModelTableData" class="" style="width: 100%;">

    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef>Name</th>
      <td mat-cell *matCellDef="let row">
        <!-- if ValueType -->
        <ng-container *ngIf="isObjectProperty(row)">
          <span>
            {{row.ObjectPropertyValue.Property.name}}
          </span>
        </ng-container>

        <!-- if DataType -->
        <ng-container *ngIf="isDataProperty(row)">
          <span>
            {{row.DataPropertyValue.Property.name}}
          </span>
        </ng-container>

      </td>
    </ng-container>

    <ng-container matColumnDef="type">
      <th mat-header-cell *matHeaderCellDef>Type</th>
      <td mat-cell *matCellDef="let row">
        <!-- if ValueType -->
        <ng-container *ngIf="isObjectProperty(row)">
          <span>
            {{row.ObjectPropertyValue.ValueType.name}}
          </span>
        </ng-container>

        <!-- if DataType -->
        <ng-container *ngIf="isDataProperty(row)">
          <span>
            {{row.DataPropertyValue.DataType.iri}}
          </span>
        </ng-container>

      </td>
    </ng-container>

    <ng-container matColumnDef="cardinality">
      <th mat-header-cell *matHeaderCellDef>Cardinality</th>
      <td mat-cell *matCellDef="let row">
        <ng-container *ngIf="isObjectProperty(row)">
          {{(row.ObjectPropertyValue.Min ? row.ObjectPropertyValue.Min : DEFAULT_MIN_CARDINALITY)}} :
          {{(row.ObjectPropertyValue.Max ? row.ObjectPropertyValue.Max : DEFAULT_MAX_CARDINALITY)}}
        </ng-container>
        <ng-container *ngIf="isDataProperty(row)">
          {{(row.DataPropertyValue.Min ? row.DataPropertyValue.Min : DEFAULT_MIN_CARDINALITY)}} :
          {{(row.DataPropertyValue.Max ? row.DataPropertyValue.Max : DEFAULT_MAX_CARDINALITY)}}
        </ng-container>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="hoveredDataModelTable.columns"></tr>
    <tr mat-row *matRowDef="let row; columns: hoveredDataModelTable.columns;"></tr>
  </table>
</ng-template>

<!-- SideBar -->
<mat-drawer #drawer class="example-sidenav" mode="over" position="end" [(opened)]="sidebar"
style="width: 40%;overflow:hidden;">

<mat-card *ngIf="concept != null && perspective != null && summaryProvider != null">

    <!-- Header -->
    <app-card-header [title]="perspective.caption + ' - ' + concept.name" 
                     [subtitle]=""
                     [icon]="perspective.icon" 
                     [color]="perspective.color" 
                     style="height: 64px;"
                     [showActions]="true">
    </app-card-header>

    <mat-card-content class="full-page-card">
      
      <ng-container *ngIf="concept.description != null">
        <span [innerHTML]="concept.description"></span>
      </ng-container>

      <ng-container *ngTemplateOutlet="this[summaryProvider.templateName]; context: { summaryProvider: summaryProvider }"></ng-container>

    </mat-card-content> 
</mat-card>
</mat-drawer>